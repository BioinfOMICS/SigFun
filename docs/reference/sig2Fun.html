<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Signature-to-Function Analysis — sig2Fun • SigFun</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Signature-to-Function Analysis — sig2Fun"><meta name="description" content="Analyzes gene signatures and identifies their associated
biological functions by using the whole transcriptome as a surrogate.
This function provides a comprehensive solution for functional analysis of
multi-gene signatures regardless of their size, addressing limitations of
conventional methods like ORA and GSEA for small gene sets. It can handle
signatures in various formats including binary values (e.g., high/low risk
classifications) and continuous values (e.g., prognostic risk scores)."><meta property="og:description" content="Analyzes gene signatures and identifies their associated
biological functions by using the whole transcriptome as a surrogate.
This function provides a comprehensive solution for functional analysis of
multi-gene signatures regardless of their size, addressing limitations of
conventional methods like ORA and GSEA for small gene sets. It can handle
signatures in various formats including binary values (e.g., high/low risk
classifications) and continuous values (e.g., prognostic risk scores)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SigFun</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/QuickStart.html">QuickStart with Streamlined Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/Data_Preparation.html">Data Preparation</a></li>
    <li><a class="dropdown-item" href="../articles/Stepwise_Workflow.html">Stepwise Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/Visualization_Functions.html">Visualization Functions</a></li>
    <li><a class="dropdown-item" href="../articles/Custom_Gene_Ranking.html">Custom Gene Ranking</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TMSWCChenglab/SigFun/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Signature-to-Function Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/TMSWCChenglab/SigFun/blob/HEAD/R/sig2Fun.R" class="external-link"><code>R/sig2Fun.R</code></a></small>
      <div class="d-none name"><code>sig2Fun.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Analyzes gene signatures and identifies their associated
biological functions by using the whole transcriptome as a surrogate.
This function provides a comprehensive solution for functional analysis of
multi-gene signatures regardless of their size, addressing limitations of
conventional methods like ORA and GSEA for small gene sets. It can handle
signatures in various formats including binary values (e.g., high/low risk
classifications) and continuous values (e.g., prognostic risk scores).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sig2Fun</span><span class="op">(</span></span>
<span>  <span class="va">seData</span>,</span>
<span>  <span class="va">t2g</span>,</span>
<span>  rankingMethod <span class="op">=</span> <span class="st">"cor"</span>,</span>
<span>  topN <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"human"</span>,</span>
<span>  corMethod <span class="op">=</span> <span class="st">"spearman"</span>,</span>
<span>  zTransform <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  significantType <span class="op">=</span> <span class="st">"pval"</span>,</span>
<span>  strings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOBP"</span>, <span class="st">"REACTOME"</span>, <span class="st">"HALLMARK"</span>, <span class="st">"SIGNALING"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sedata">seData<a class="anchor" aria-label="anchor" href="#arg-sedata"></a></dt>
<dd><p>A SummarizedExperiment object containing:
- assays: Gene expression matrix, genes in rows, samples in columns
- colData: Signature scores for each sample
- rowData: Gene annotation including gene symbols that match the
pathway database
See vignette for detailed structure requirements.</p></dd>


<dt id="arg-t-g">t2g<a class="anchor" aria-label="anchor" href="#arg-t-g"></a></dt>
<dd><p>List containing biological functions and their
corresponding genes.
Should be obtained from MSigDB (e.g., msigdb.v2023.1.Hs.symbols.gmt)
or a custom gene set.
Each list element represents a pathway with genes as vector elements.</p></dd>


<dt id="arg-rankingmethod">rankingMethod<a class="anchor" aria-label="anchor" href="#arg-rankingmethod"></a></dt>
<dd><p>Character. Method to rank genes for pathway analysis:
- "cor" (default): Use test statistics
- "pval": Use p-values</p></dd>


<dt id="arg-topn">topN<a class="anchor" aria-label="anchor" href="#arg-topn"></a></dt>
<dd><p>Integer. Number of top significant functions to display in output
plots.
Default is 10.</p></dd>


<dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p>Character. Organism of the dataset:
- "human" (default)
- "mouse"</p></dd>


<dt id="arg-cormethod">corMethod<a class="anchor" aria-label="anchor" href="#arg-cormethod"></a></dt>
<dd><p>Character. Statistical method for correlation analysis:
- "spearman" (default): For general correlations
- "pearson": For linear relationships
- "kendall": For non-parametric rank correlation
- "logit": For binary signatures (e.g., high/low risk classification)</p></dd>


<dt id="arg-ztransform">zTransform<a class="anchor" aria-label="anchor" href="#arg-ztransform"></a></dt>
<dd><p>Logical. Whether to perform z-transformation on gene
expression data:
- FALSE (default): No transformation
- TRUE: Apply z-transformation (standardization)
For binary signatures (e.g., using logit correlation), set to FALSE.</p></dd>


<dt id="arg-significanttype">significantType<a class="anchor" aria-label="anchor" href="#arg-significanttype"></a></dt>
<dd><p>Character. Method for statistical significance
filtering:
- "pval": Use p-values (default)
- "qval": Use Q-values (adjusted p-values)</p></dd>


<dt id="arg-strings">strings<a class="anchor" aria-label="anchor" href="#arg-strings"></a></dt>
<dd><p>Character vector. Specifies which pathway categories to
include in visualization.
Default includes: c("GOBP", "GOCC", "GOMF", "KEGG", "REACTOME",
"WP", "HALLMARK", "SIGNALING")
For example, "HALLMARK" will filter for pathways containing it.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an enhanced SummarizedExperiment object with additional slots
containing:
- Correlation results between signature and gene expression
- Pathway enrichment analysis results
- Visualization objects:
* barplots: Bar plots showing top functions associated with the
signature, ordered by significance and colored by association
direction
* heatmap: Heatmaps displaying NES values, p-values, score
distribution, and names of significantly associated functions</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load demo dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"expr.data"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mapping"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SIG_MAT"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"t2g"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">seData</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>assays<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>abundance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">expr.data</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>rowData<span class="op">=</span><span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span><span class="va">mapping</span>, row.names<span class="op">=</span><span class="va">mapping</span><span class="op">$</span><span class="va">ensg_id</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>colData<span class="op">=</span><span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span><span class="va">SIG_MAT</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># For analysis of binary signature (e.g., MammaPrint high/low risk)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">sig2Fun</span><span class="op">(</span>seData<span class="op">=</span><span class="va">seData</span>, t2g<span class="op">=</span><span class="va">t2g</span>, rankingMethod<span class="op">=</span><span class="st">"cor"</span>,</span></span>
<span class="r-in"><span>species<span class="op">=</span><span class="st">"human"</span>, corMethod<span class="op">=</span><span class="st">"logit"</span>, topN<span class="op">=</span><span class="fl">10</span>, zTransform<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>significantType<span class="op">=</span><span class="st">"pval"</span>, strings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HALLMARK"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> using 'fgsea' for GSEA analysis, please cite Korotkevich et al (2019).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> preparing geneSet collections...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> GSEA analysis...</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>For some of the pathways the P-values were likely overestimated. For such pathways log2err is set to NA.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>For some pathways, in reality P-values are less than 1e-10. You can set the `eps` argument to zero for better estimation.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> leading edge analysis...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done...</span>
<span class="r-in"><span><span class="co"># To visualize Heatmap results: res$heatmap</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wei-Chung Cheng, Chia-Hsin Liu, Pei-Chun Shen, Wen-Jen Lin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

