<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Visualization of Pathway Enrichment Results — plot_heat • SigFun</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualization of Pathway Enrichment Results — plot_heat"><meta name="description" content="The plot_heat function generates multi-panel heatmap
visualizations of Gene Set Enrichment Analysis (GSEA) results, displaying
normalized enrichment scores (NES), significance values, and gene ranking
patterns. Each heatmap panel highlights the distribution and direction of
pathway enrichment, allowing visual comparison across multiple pathway
categories."><meta property="og:description" content="The plot_heat function generates multi-panel heatmap
visualizations of Gene Set Enrichment Analysis (GSEA) results, displaying
normalized enrichment scores (NES), significance values, and gene ranking
patterns. Each heatmap panel highlights the distribution and direction of
pathway enrichment, allowing visual comparison across multiple pathway
categories."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SigFun</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/QuickStart.html">QuickStart with Streamlined Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/Data_Preparation.html">Data Preparation</a></li>
    <li><a class="dropdown-item" href="../articles/Stepwise_Workflow.html">Stepwise Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/Visualization_Functions.html">Visualization Functions</a></li>
    <li><a class="dropdown-item" href="../articles/Custom_Gene_Ranking.html">Custom Gene Ranking</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TMSWCChenglab/SigFun/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualization of Pathway Enrichment Results</h1>
      <small class="dont-index">Source: <a href="https://github.com/TMSWCChenglab/SigFun/blob/HEAD/R/plot_heat.R" class="external-link"><code>R/plot_heat.R</code></a></small>
      <div class="d-none name"><code>plot_heat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>plot_heat</code> function generates multi-panel heatmap
visualizations of Gene Set Enrichment Analysis (GSEA) results, displaying
normalized enrichment scores (NES), significance values, and gene ranking
patterns. Each heatmap panel highlights the distribution and direction of
pathway enrichment, allowing visual comparison across multiple pathway
categories.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_heat</span><span class="op">(</span></span>
<span>  <span class="va">seDataFgsea</span>,</span>
<span>  significantType <span class="op">=</span> <span class="st">"pval"</span>,</span>
<span>  topN <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  <span class="va">pathwaysAll</span>,</span>
<span>  strings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOBP"</span>, <span class="st">"GOCC"</span>, <span class="st">"GOMF"</span>, <span class="st">"KEGG"</span>, <span class="st">"REACTOME"</span>, <span class="st">"WP"</span>, <span class="st">"HALLMARK"</span><span class="op">)</span>,</span>
<span>  rankingMethod <span class="op">=</span> <span class="st">"cor"</span>,</span>
<span>  colWidths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">0.8</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">4.5</span><span class="op">)</span>,</span>
<span>  breaklineN <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  fontSize <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  pvalueType <span class="op">=</span> <span class="st">"pvalue"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sedatafgsea">seDataFgsea<a class="anchor" aria-label="anchor" href="#arg-sedatafgsea"></a></dt>
<dd><p>A <code>SummarizedExperiment</code> object containing:</p><ul><li><p><code>metadata(seDataFgsea)$cor.df</code>: Correlation statistics from
<code>sigCor</code>.</p></li>
<li><p><code>metadata(seDataFgsea)$gseaResult</code>: GSEA result object from
<code>sig2GSEA</code>, containing NES and p-value statistics.</p></li>
</ul></dd>


<dt id="arg-significanttype">significantType<a class="anchor" aria-label="anchor" href="#arg-significanttype"></a></dt>
<dd><p>Character. Type of significance metric used for
filtering enriched pathways:</p><ul><li><p><code>"pval"</code> (default): Nominal p-values.</p></li>
<li><p><code>"padj"</code>: Adjusted p-values.</p></li>
</ul></dd>


<dt id="arg-topn">topN<a class="anchor" aria-label="anchor" href="#arg-topn"></a></dt>
<dd><p>Integer. Number of top significant pathways to display per
category. Default is <code>10</code>.</p></dd>


<dt id="arg-pathwaysall">pathwaysAll<a class="anchor" aria-label="anchor" href="#arg-pathwaysall"></a></dt>
<dd><p>List. Pathway database (e.g. MSigDB collection), typically
generated by splitting <code>t2g$ensembl_gene</code> by <code>t2g$gs_name</code>.</p></dd>


<dt id="arg-strings">strings<a class="anchor" aria-label="anchor" href="#arg-strings"></a></dt>
<dd><p>Character vector specifying pathway categories to visualize
(e.g. <code>c("HALLMARK", "KEGG", "REACTOME")</code>). Default includes major
MSigDB collections.</p></dd>


<dt id="arg-rankingmethod">rankingMethod<a class="anchor" aria-label="anchor" href="#arg-rankingmethod"></a></dt>
<dd><p>Character. Column name in <code>cor.df</code> used as ranking
metric for GSEA (e.g. <code>"cor"</code> or <code>"pval"</code>). Default is
<code>"cor"</code>.</p></dd>


<dt id="arg-colwidths">colWidths<a class="anchor" aria-label="anchor" href="#arg-colwidths"></a></dt>
<dd><p>Numeric vector of length 5 controlling the relative column
widths in the multi-panel grid layout. Corresponds to
<code>("NES bar", "NES", "pvalueType", "Enrichment plot", "Pathway name")</code>.
Default is <code>c(1.5, 0.8, 1, 6, 4.5)</code>.</p></dd>


<dt id="arg-breaklinen">breaklineN<a class="anchor" aria-label="anchor" href="#arg-breaklinen"></a></dt>
<dd><p>Integer. Number of characters after which to break long
pathway names into multiple lines. Default is <code>30</code>.</p></dd>


<dt id="arg-fontsize">fontSize<a class="anchor" aria-label="anchor" href="#arg-fontsize"></a></dt>
<dd><p>Numeric. Font size for pathway labels and annotations.
Default is <code>8</code>.</p></dd>


<dt id="arg-pvaluetype">pvalueType<a class="anchor" aria-label="anchor" href="#arg-pvaluetype"></a></dt>
<dd><p>Character. Column name in the GSEA results used to represent
statistical significance. Must be one of <code>"pvalue"</code>,
<code>"p.adjust"</code>, or <code>"qvalue"</code>. Default is <code>"pvalue"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list of <code>ggplot</code> objects. Each element corresponds to a
pathway category (as defined in <code>strings</code>) and contains a multi-panel
heatmap visualization.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function visualizes GSEA enrichment results across pathway categories
using a composite heatmap layout. Each heatmap includes multiple aligned
panels summarizing:</p><ol><li><p>Normalized enrichment scores (NES)</p></li>
<li><p>Significance values (-log10 transformed)</p></li>
<li><p>Enrichment score distribution</p></li>
<li><p>Pathway names with leading-edge genes</p></li>
</ol><p>Color gradients represent the direction of association
(<em>red = positive</em>, <em>blue = negative</em>).
The function automatically selects top enriched pathways per collection
(defined in <code>strings</code>) and integrates gene ranking data for each
pathway set.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Requires <span class="pkg">ggplot2</span> (&gt;= 3.5.0), <span class="pkg">dplyr</span> (&gt;= 1.1.0),
and <span class="pkg">fgsea</span> (&gt;= 1.26.0) for full compatibility.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sig2Fun_result"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">t2g</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pathwaysAll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">t2g</span><span class="op">$</span><span class="va">ensembl_gene</span>, <span class="va">t2g</span><span class="op">$</span><span class="va">gs_name</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_heat</span><span class="op">(</span>seDataFgsea <span class="op">=</span> <span class="va">sig2Fun_result</span>,</span></span>
<span class="r-in"><span>          strings <span class="op">=</span> <span class="st">"HALLMARK"</span>,</span></span>
<span class="r-in"><span>          pathwaysAll <span class="op">=</span> <span class="va">pathwaysAll</span>,</span></span>
<span class="r-in"><span>          topN <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $HALLMARK</span>
<span class="r-plt img"><img src="plot_heat-1.png" alt="" width="672" height="461"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wei-Chung Cheng, Chia-Hsin Liu, Pei-Chun Shen, Wen-Jen Lin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

