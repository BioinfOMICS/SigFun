% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sig2Fun.R
\name{sig2Fun}
\alias{sig2Fun}
\title{Signature-to-Function Analysis}
\usage{
sig2Fun(
  SE_data,
  ranking.method = "stat",
  species = "human",
  cor.method = "spearman",
  pathways_all,
  topN = 10,
  Z.transform = FALSE,
  significat_type = "pval",
  strings = c("GOBP", "GOCC", "GOMF", "KEGG", "REACTOME", "WP", "HALLMARK", "SIGNALING")
)
}
\arguments{
\item{SE_data}{A SummarizedExperiment object containing:
- assays: Gene expression matrix, genes in rows, samples in columns
- colData: Signature scores for each sample
- rowData: Gene annotation including gene symbols that match the
pathway database
See vignette for detailed structure requirements.}

\item{ranking.method}{Character. Method to rank genes for pathway analysis:
- "stat" (default): Use test statistics
- "pval": Use p-values}

\item{species}{Character. Organism of the dataset:
- "human" (default)
- "mouse"}

\item{cor.method}{Character. Statistical method for correlation analysis:
- "spearman" (default): For general correlations
- "pearson": For linear relationships
- "kendall": For non-parametric rank correlation
- "logit": For binary signatures (e.g., high/low risk classification)}

\item{pathways_all}{List containing biological functions and their
corresponding genes.
Should be obtained from MSigDB (e.g., msigdb.v2023.1.Hs.symbols.gmt)
or a custom gene set.
Each list element represents a pathway with genes as vector elements.}

\item{topN}{Integer. Number of top significant functions to display in output
plots.
Default is 10.}

\item{Z.transform}{Logical. Whether to perform z-transformation on gene
expression data:
- FALSE (default): No transformation
- TRUE: Apply z-transformation (standardization)
For binary signatures (e.g., using logit correlation), set to FALSE.}

\item{significat_type}{Character. Method for statistical significance
filtering:
- "pval": Use p-values (default)
- "qval": Use Q-values (adjusted p-values)}

\item{strings}{Character vector. Specifies which pathway categories to
include in visualization.
Default includes: c("GOBP", "GOCC", "GOMF", "KEGG", "REACTOME",
"WP", "HALLMARK", "SIGNALING")
For example, "HALLMARK" will filter for pathways containing it.}
}
\value{
Returns an enhanced SummarizedExperiment object with additional slots
containing:
- Correlation results between signature and gene expression
- Pathway enrichment analysis results
- Visualization objects:
* barplots: Bar plots showing top functions associated with the
signature, ordered by significance and colored by association
direction
* heatmap: Heatmaps displaying NES values, p-values, score
distribution, and names of significantly associated functions
}
\description{
Analyzes gene signatures and identifies their associated
biological functions by using the whole transcriptome as a surrogate.
This function provides a comprehensive solution for functional analysis of
multi-gene signatures regardless of their size, addressing limitations of
conventional methods like ORA and GSEA for small gene sets. It can handle
signatures in various formats including binary values (e.g., high/low risk
classifications) and continuous values (e.g., prognostic risk scores).
}
\examples{
# Load demo dataset
data("demo_GSE181574")

# For analysis of binary signature (e.g., MammaPrint high/low risk)
res <- sig2Fun(
  SE_data = SE_GSE181574,
  ranking.method = "stat",
  species = "human",
  cor.method = "logit",  # Use logit for binary variables
  pathways_all = pathways.all,
  topN = 10,
  Z.transform = FALSE,  # No normalization needed for binary variables
  significat_type = "pval",
  strings = c("HALLMARK")
)

# To visualize results:
# 1. Bar plot: res$barplots
# 2. Heatmap: res$heatmap
}
