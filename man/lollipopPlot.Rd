% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lollipopPlot.R
\name{lollipopPlot}
\alias{lollipopPlot}
\title{lollipopPlot}
\usage{
lollipopPlot(
  seDataFgsea,
  showCategory = 10,
  breaklineN = 30,
  x = "NES",
  alpha = "p.adjust",
  size = "Count",
  fontSize = 10,
  addSeg = TRUE,
  lineSize = 1,
  lineType = "solid"
)
}
\arguments{
\item{seDataFgsea}{A \code{SummarizedExperiment} object containing GSEA
results in its metadata.}

\item{showCategory}{Numeric or character. Number of top pathways to display
or specific pathway names to include. When numeric:
\itemize{
\item If \code{x = "NES"}: Displays top N positively enriched and top N
negatively enriched pathways (up to 2N total pathways)
\item If \code{x} is \code{"Count"} or \code{"GeneRatio"}: Displays top N
pathways sorted by the specified metric
}
When character: Displays only the specified pathway IDs/names.
Default is \code{10}.}

\item{breaklineN}{Integer. Maximum number of characters before wrapping
pathway names. Default is \code{30}.}

\item{x}{Character. Variable for the x-axis. Must be one of \code{"NES"},
\code{"Count"}, or \code{"GeneRatio"}. Default is \code{"NES"}.}

\item{alpha}{Character. Variable for transparency encoding. Must be one of
\code{"pvalue"}, \code{"p.adjust"}, or \code{"qvalue"}. Default is
\code{"p.adjust"}.}

\item{size}{Character. Variable for dot size. Must be one of \code{"Count"}
or \code{"GeneRatio"}. Default is \code{"Count"}.}

\item{fontSize}{Numeric. Base font size for plot text elements.
Default is \code{10}.}

\item{addSeg}{Logical. Whether to include connecting line segments between
the y-axis and dots (the "stick" of the lollipop). When \code{FALSE},
only dots are displayed. Default is \code{TRUE}.}

\item{lineSize}{Numeric. Line thickness for the connecting segments when
\code{addSeg = TRUE}. Default is \code{1}.}

\item{lineType}{Character. Line type for the connecting segments when
\code{addSeg = TRUE}. Options include \code{"solid"}, \code{"dashed"},
\code{"dotted"}, etc. Default is \code{"solid"}.}
}
\value{
A named list containing two components:
\describe{
\item{\code{lollipopPlot}}{A \code{ggplot2} object of the lollipop plot
with pathways on the y-axis and enrichment metrics on the x-axis.}
\item{\code{tableLollipopPlot}}{A \code{data.frame} containing the
plotted data with columns:
\itemize{
\item \code{original_name}: Original pathway IDs
\item \code{Description}: Formatted pathway names with line breaks
\item X-axis variable: The column specified by the \code{x} parameter
(\code{NES}, \code{Count}, or \code{GeneRatio})
\item Significance column: The column specified by the \code{alpha}
parameter (\code{pvalue}, \code{p.adjust}, or \code{qvalue})
\item \code{neg_log_alpha}: Transformed significance value
(-log10(alpha))
\item Size variable: The column specified by the \code{size} parameter
(\code{Count} or \code{GeneRatio})
}}
}
}
\description{
The \code{lollipopPlot} function generates a lollipop-style
visualization of Gene Set Enrichment Analysis (GSEA) results. Each
horizontal line represents a pathway, and the dot at its end marks the
enrichment statistic (e.g., NES or GeneRatio). Dot size and transparency
encode statistical significance, while color indicates enrichment
direction. The connecting line segments can be toggled on or off.
}
\details{
This function creates a lollipop chart where each pathway is represented
by a horizontal line segment (the "stick", controlled by \code{addSeg})
ending in a dot (the "pop"). The visual encoding follows these rules:
\itemize{
\item \strong{X-axis position:} Enrichment metric (NES, Count, or
GeneRatio)
\item \strong{Dot size:} Gene count or gene ratio
\item \strong{Dot/line color:} Enrichment direction (red for enriched,
blue for depleted when x = "NES"; red only for other metrics)
\item \strong{Transparency (alpha):} Statistical significance
(-log10 transformed)
\item \strong{Line segments:} Optional connecting lines from y-axis to
dots, controlled by \code{addSeg}
}
}
\examples{
data("sig2Fun_result")
lollipopPlot(seDataFgsea = sig2Fun_result)
}
